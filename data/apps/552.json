{
  "task_id": "APPS/552",
  "problem_id": 552,
  "prompt": "Vasya had three strings $a$, $b$ and $s$, which consist of lowercase English letters. The lengths of strings $a$ and $b$ are equal to $n$, the length of the string $s$ is equal to $m$. \n\nVasya decided to choose a substring of the string $a$, then choose a substring of the string $b$ and concatenate them. Formally, he chooses a segment $[l_1, r_1]$ ($1 \\leq l_1 \\leq r_1 \\leq n$) and a segment $[l_2, r_2]$ ($1 \\leq l_2 \\leq r_2 \\leq n$), and after concatenation he obtains a string $a[l_1, r_1] + b[l_2, r_2] = a_{l_1} a_{l_1 + 1} \\ldots a_{r_1} b_{l_2} b_{l_2 + 1} \\ldots b_{r_2}$.\n\nNow, Vasya is interested in counting number of ways to choose those segments adhering to the following conditions:\n\n  segments $[l_1, r_1]$ and $[l_2, r_2]$ have non-empty intersection, i.e. there exists at least one integer $x$, such that $l_1 \\leq x \\leq r_1$ and $l_2 \\leq x \\leq r_2$;  the string $a[l_1, r_1] + b[l_2, r_2]$ is equal to the string $s$. \n\n\n-----Input-----\n\nThe first line contains integers $n$ and $m$ ($1 \\leq n \\leq 500\\,000, 2 \\leq m \\leq 2 \\cdot n$)\u00a0\u2014 the length of strings $a$ and $b$ and the length of the string $s$.\n\nThe next three lines contain strings $a$, $b$ and $s$, respectively. The length of the strings $a$ and $b$ is $n$, while the length of the string $s$ is $m$.\n\nAll strings consist of lowercase English letters.\n\n\n-----Output-----\n\nPrint one integer\u00a0\u2014 the number of ways to choose a pair of segments, which satisfy Vasya's conditions.\n\n\n-----Examples-----\nInput\n6 5\naabbaa\nbaaaab\naaaaa\n\nOutput\n4\n\nInput\n5 4\nazaza\nzazaz\nazaz\n\nOutput\n11\n\nInput\n9 12\nabcabcabc\nxyzxyzxyz\nabcabcayzxyz\n\nOutput\n2\n\n\n\n-----Note-----\n\nLet's list all the pairs of segments that Vasya could choose in the first example:\n\n  $[2, 2]$ and $[2, 5]$;  $[1, 2]$ and $[2, 4]$;  $[5, 5]$ and $[2, 5]$;  $[5, 6]$ and $[3, 5]$;",
  "solutions": "[\"import sys, logging\\nlogging.basicConfig(level=logging.INFO)\\nlogging.disable(logging.INFO)\\n\\ndef build(S, n):\\n    Z = [0 for i in range(3 * n + 3)]\\n    #logging.info(S)\\n    n = len(S)\\n    L = 0\\n    R = 0\\n    Z[0] = n\\n    for i in range(1, n):\\n        if(i > R):\\n            L = R = i\\n            while(R < n and S[R] == S[R - L]):\\n                R += 1\\n            Z[i] = R - L\\n            R -= 1\\n        else:\\n            k = i - L\\n            if(Z[k] < R - i + 1):\\n                Z[i] = Z[k]\\n            else:\\n                L = i\\n                while(R < n and S[R] == S[R - L]):\\n                    R += 1\\n                Z[i] = R - L\\n                R -= 1\\n    return Z\\n\\ndef update1(n, x, val):\\n    while(x <= n + 1):\\n        bit1[x] += val\\n        x += x & -x\\n\\ndef get1(n, x):\\n    ans = 0\\n    while(x > 0):\\n        ans += bit1[x]\\n        x -= x & -x\\n    return ans\\n\\ndef update2(n, x, val):\\n    while(x <= n + 1):\\n        bit2[x] += val\\n        x += x & -x\\n\\ndef get2(n, x):\\n    ans = 0\\n    while(x > 0):\\n        ans += bit2[x]\\n        x -= x & -x\\n    return ans\\n\\ndef process(n, m, fa, fb):\\n    r2 = int(1)\\n    ans = 0\\n    for l1 in range(1, n + 1):\\n        while(r2 <= min(n, l1 + m - 2)):\\n            update1(n, m - fb[r2] + 1, 1)\\n            update2(n, m - fb[r2] + 1, fb[r2] - m + 1)\\n            r2 += 1\\n        ans += get1(n, fa[l1] + 1) * fa[l1] + get2(n, fa[l1] + 1)\\n        update1(n, m - fb[l1] + 1, -1)\\n        update2(n, m - fb[l1] + 1, m - 1 - fb[l1])\\n    print(ans)\\n\\ndef main():\\n    n, m = map(int, sys.stdin.readline().split())\\n    a = sys.stdin.readline()\\n    b = sys.stdin.readline()\\n    s = sys.stdin.readline()\\n    a = a[:(len(a) - 1)]\\n    b = b[:(len(b) - 1)]\\n    s = s[:(len(s) - 1)]\\n    fa = build(s + a, n)\\n    kb = build(s[::-1] + b[::-1], n)\\n    fb = [0 for k in range(n + 2)]\\n    for i in range(m, m + n):\\n        fa[i - m + 1] = fa[i]\\n        if(fa[i - m + 1] >= m):\\n            fa[i - m + 1] = m - 1\\n        fb[m + n - i] = kb[i]\\n        if(fb[m + n - i] >= m):\\n            fb[m + n - i] = m - 1\\n    logging.info(fa[1:(n + 1)])\\n    logging.info(fb[1:(n + 1)])\\n    process(n, m, fa, fb)\\n\\nbit1 = [0 for i in range(500004)]\\nbit2 = [0 for i in range(500004)]\\n\\ndef __starting_point():\\n    try:\\n        sys.stdin = open('input.txt', 'r')\\n        sys.stdout = open('output.txt', 'w')\\n    except:\\n        pass\\n    main()\\n__starting_point()\"]",
  "input_output": "{\n  \"inputs\": [\n    \"6 5\\naabbaa\\nbaaaab\\naaaaa\\n\",\n    \"5 4\\nazaza\\nzazaz\\nazaz\\n\",\n    \"9 12\\nabcabcabc\\nxyzxyzxyz\\nabcabcayzxyz\\n\",\n    \"1 2\\nt\\nt\\ntt\\n\",\n    \"20 40\\nxxxxxxxxxxxxxxxxxxxx\\nxxxxxxxxxxxxxxxxxxxx\\nxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\\n\",\n    \"20 27\\nmmmmmmmmmmmmmmmmmmmm\\nmmmmmmmmmmmmmmmmmmmm\\nmmmmmmmmmmmmmmmmmmmmmmmmmmm\\n\",\n    \"20 2\\nrrrrrrrrrrrrrrrrrrrr\\nrrrrrrrrrrrrrrrrrrrr\\nrr\\n\",\n    \"20 10\\naaaaaaaaaamaaaaaaaax\\nfaaaaaaaaaaaaaaaaaaa\\naaaaaaaaaa\\n\",\n    \"20 31\\npspsppspsppsppspspps\\nspspsspspsspsspspssp\\npspsppsppspsppspsspspsspsspspss\\n\",\n    \"19 13\\nfafaffafaffaffafaff\\nafafaafafaafaafafaa\\nfafafafafaafa\\n\",\n    \"20 23\\nzizizzizizzizzizizzi\\niziziizizpiziiziziiz\\nzizizzizzizizziiziziizi\\n\",\n    \"20 17\\nkpooixkpooixkpokpowi\\noixtpooixkpooixoixkp\\npooixkpoixkpooixk\\n\",\n    \"20 25\\nzvozvozvozvozvozvozv\\nozvozvozvozvozvozvoz\\nzvozvozvozvozvozvozvozvoz\\n\",\n    \"20 40\\ngvgvgvgvgvgvgvgvgvgv\\ngvgvgvgvgvgvgvgvgvgv\\ngvgvgvgvgvgvgvgvgvgvgvgvgvgvgvgvgvgvgvgv\\n\",\n    \"20 35\\ncyvvqscyvvqscyvvqscy\\nscyvvqscyvvqscyvvqsc\\nvqscyvvqscyvvqscyvvqscyvvqscyvvqscy\\n\",\n    \"20 6\\ndqgdqgdqydqgdqgqqgdq\\ndqtdqgdqgdqgdqgdfgdq\\ndqgdqg\\n\",\n    \"20 40\\nypqwnaiotllzrsoaqvau\\nzjveavedxiqzzusesven\\nypqwnaiotllzrsoaqvauzjveavedxiqzzusesven\\n\",\n    \"20 40\\nxdjlcpeaimrjukhizoan\\nobkcqzkcrvxxfbrvzoco\\nxdrlcpeaimrjukhizoanobkcqzkcrvxxfbrvzoco\\n\",\n    \"20 22\\nxsxxsxssxsxxssxxsxss\\nxssxsxxssxxsxssxxssx\\nxxsxssxsxxssxxsxssxsxx\\n\",\n    \"20 15\\nwwawaawwaawawwaawwaw\\nawawwawaawhaawcwwawa\\nwwawaawwaawawwa\\n\",\n    \"20 10\\ndctctdtdcctdtdcdcttd\\ntdcdctdctctdtdcctdtd\\ncdctctddct\\n\",\n    \"20 8\\nurrndundurdurnurndnd\\nurndrnduurndrndundur\\nrndundur\\n\",\n    \"20 11\\nlmmflflmlmflmfmflflm\\nmlmfmfllmfaflflmflml\\nlmlmfmfllmf\\n\",\n    \"100 200\\ndddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd\\ndddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd\\ndddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd\\n\",\n    \"100 100\\nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\\nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\\nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\\n\",\n    \"100 2\\ntttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttt\\ntttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttt\\ntt\\n\",\n    \"100 20\\nrrrrrrprrjrrrhrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrerrwrrrrrrrrrrrrlrrrrrr\\nrrrrrrrrrrrrlrrrrkrrrrrrrrrrrrrrrrrrrrrrrrrqrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrcrrrrrrrr\\nrrrrrrrrrrrrrrrrrrrr\\n\",\n    \"100 33\\nuuuluyguuuuuuuouuwuuumuuuuuuuuluuuvuuuuzfuuuuusuuuuuuuuuuuuuuuuuuuuuuuuduunuuuuuuhuuuuuuuueuuumuuumu\\nuueuuuuuuuuuuuuuzuuuuuuuuuuuuuuuuuuuduuuuuuuuuuuuuuouuuuuueuuuuaujuuruuuuuguuuuuuuuuuuuuuuuuuuuuuuuw\\nuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu\\n\",\n    \"100 94\\nmkmkmmkmkmmkmmkmkmmkmkmmkmmkmkmmkmmkmkmmkmkmmkmmkmkmmkmkmmkmmkmkmmkmmkmkmmkmkmmkmmkmkmmkmmkmkmmkmkmm\\nkmkmkkmkmkkmkkmkmkkmkmkkmkkmkmkkmkkmkmkkmkmkkmkkmkmkkmkmkkmkkmkmkkmkkmkmkkmkmkkmkkmkmkkmkkmkmkkmkmkk\\nkmkmmkmkmmkmmkmkmmkmkmmkmmkmkmmkmmkmkmmkmkkmkmkkmkmkkmkkmkmkkmkmkkmkkmkmkkmkkmkmkkmkmkkmkkmkmk\\n\",\n    \"100 136\\ncunhfnhfncunhfnhfncunhfncunhfnhfncunhfnhfncunhfncunhfnhfncunhfncunhfnhfncunhfnhfncunhfncunhfnhfncunh\\nhfncuncunhfncuncunhfncunhfncuncunhfncuncunhfncunhfncuncunhfncunhfncuncunhfncuncunhfncunhfncuncunhfnc\\nhfncunhfnhfncunhfnhfncunhfncunhfnhfncunhfncunhfnhfncunhfnhfncunhfncunhfnhfnhfncuncunhfncunhfncuncunhfncunhfncuncunhfncuncunhfncunhfncunc\\n\",\n    \"100 24\\nzvahgmahgmzvahgmahgmzvahgmzvahgmahgmzvahgmahgmzvahgmzvahgmahgmzvahgmzvahgmahgmzvahgmahgmzvahgmzvahgm\\nzvahgmzvahgmzvzvahgmzvahgmzvzvahgmzvzvahgmzvahgmzvzvahgmzvahgmzvzvahgmzvzvahgmzvahgmzvzvahgmzvzvahgm\\ngmahgmzvahgmahgmzvahgmzv\\n\",\n    \"99 105\\nanhrqanhrqanhranhrqanhrqanhranhrqanhranhrqanhrqanhranhrqanhrqanhranhaqanhranhrqanhrqanhranhrqanhran\\nqanhrqanhrqqanhrqanhrqqanhrqqanhrqanhrqqanhraanhrqqanhrqqanhrqanhrqqanhrqqanhrqanhrqqanhrqanhrqqanh\\nanhranhrqanhrqanhranhrqanhranhrqanhrqanhranhrqanhrqanhrqanhrqqanhrqqanhrqanhrqqanhrqanhrqqanhrqqanhrqanhr\\n\",\n    \"100 10\\nedcfynedcfynedcfynedcfynedcfynegcfynedcfynedcfynedcfynedcfynedcfwnedcfynedcfynedcfynedcfynedcfynedcf\\nnedcfynedcfynedcfynedcfynedcfynedcfynedcfynedcfynedcfynedcfynedcfynedcfynedcfynedcfynedcfynedcdynedc\\nfynedcfyne\\n\",\n    \"100 100\\nxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxb\\nxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxb\\nxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxbxb\\n\",\n    \"100 133\\nsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfds\\ndsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfd\\nfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsfdsf\\n\",\n    \"100 200\\noqbywigblumgeyvlesocpdrevxgyjgjjwzjldwjqeodthpjvygateqslhidczhwlaafovdjsdmzfyfiqoojsyszqjbrzlnqboets\\nxkxlxbmdzvtgplzpcepazuuuumwjmrftrlxbnawbeejiagywxssitkixdjdjfwthldtovkfzciaugahqexdwjnlummvtgbpawxbs\\noqbywigblumgeyvlesocpdrevxgyjgjjwzjldwjqeodthpjvygateqslhidczhwlaafovdjsdmzfyfiqoojsyszqjbrzlnqboetsxkxlxbmdzvtgplzpcepazuuuumwjmrftrlxbnawbeejiagywxssitkixdjdjfwthldtovkfzciaugahqexdwjnlummvtgbpawxbs\\n\",\n    \"100 200\\nboyjrjoeozwqgxexhcuioymcmnkvctbmnmsycolzhooftwndexqtwbttuwwfttaxymqsjiihgsdjasaxycgoznjiorzfiwabmhsg\\nazrxzoqaombkfdlqocjgufzhtogekkfqqtkndjydeiulljvuwvtvyszrlnvumwbflyyhlqrnthiqmgoskrhzfktwcxdzidbyoqtn\\nboyjrjoeozwqgxexhcuioymcmnkvctbmnmsycolzhooftwndexqtwbttuwwfttaxymqsjiihgsdjasaxycgoznjiorzfiwabmhsgazrxzoqaombkfdlqocjgufzhtogekkzqqtkndjydeiulljvuwvtvyszrlnvumwbflyyhlqrnthiqmgoskrhzfktwcxdzidbyoqtn\\n\",\n    \"100 33\\ncqcqqccqqcqccqqccqcqqcqccqcqqccqqcqccqcqqcqccqqccqcqqcqccqcqqccqqcqccqqccqcqqccqqcqccqcqqcqccqqccqcq\\ncqccqqccqcqqcqccqcqqccqqcqccqqccqcqqccqqcqccqcqqcqccqqccqcqqcqccqcqqccqqcqccqcqqcqccqqccqcqqccqqcqcc\\nqcqqccqqcqccqcqqcqccqqccqcqqcqccq\\n\",\n    \"100 89\\nshpashpaypayshayshpyshpashpayhpaysayshpyshpashpayhpayspayshshpayhpayspayshayshpyshpahpayspayshayshpy\\nayspayshyshpashpayhpayspayshayshpshpayhpayspayshayshpyshpahpayspayshayshpyshpashpayayshpyshpashpayhp\\npayshayshpyshpashpayhpayspayshayshpyshpashpaypayshayshpyshpashpayhpaysayshpyshpashpayhpay\\n\",\n    \"100 9\\nunujjnunujujnjnunujujnnujujnjnuujnjnunujnujujnjnuujnjnunujjnunujujnujnjnunujjnunujujnnujujnjnunujujn\\nnunujnujujnjnuujnjnunujjnunujujnujnjnunujjnunujujnnujujnjnujnunujujnnujujnjnuujnpnunujnujujnjnuujnjn\\njjnunujuj\\n\",\n    \"50 100\\nejdbvpkfoymumiujhtplntndyfkkujqvkgipbrbycmwzawcely\\nyomcgzecbzkvaeziqmbkoknfavurydjupmsfnsthvdgookxfdx\\nejdbvpkfoymumiujhtplntndyfkkujqvkgipbrbycmwzawcelyyomcgzecbzkvaeziqmbkoknfavurydjupmsfnsthvdgookxfdx\\n\",\n    \"50 100\\nclentmsedhhrdafyrzkgnzugyvncohjkrknsmljsnhuycjdczg\\nchkzmprhkklrijxswxbscgxoobsmfduyscbxnmsnabrddkritf\\nclentmsedhhrdafyrzkgnzugyvncohjkrknsmljsnhuycjdczgchkzmprhkklrijxswxbscgxoobnmfduyscbxnmsnabrddkritf\\n\",\n    \"1 2\\nj\\nj\\njj\\n\"\n  ],\n  \"outputs\": [\n    \"4\\n\",\n    \"11\\n\",\n    \"2\\n\",\n    \"1\\n\",\n    \"1\\n\",\n    \"560\\n\",\n    \"20\\n\",\n    \"561\\n\",\n    \"3\\n\",\n    \"3\\n\",\n    \"1\\n\",\n    \"0\\n\",\n    \"126\\n\",\n    \"1\\n\",\n    \"0\\n\",\n    \"13\\n\",\n    \"1\\n\",\n    \"0\\n\",\n    \"4\\n\",\n    \"14\\n\",\n    \"0\\n\",\n    \"4\\n\",\n    \"10\\n\",\n    \"1\\n\",\n    \"176451\\n\",\n    \"100\\n\",\n    \"14414\\n\",\n    \"40\\n\",\n    \"10\\n\",\n    \"2\\n\",\n    \"98\\n\",\n    \"0\\n\",\n    \"120\\n\",\n    \"45276\\n\",\n    \"6072\\n\",\n    \"1\\n\",\n    \"0\\n\",\n    \"112\\n\",\n    \"0\\n\",\n    \"23\\n\",\n    \"1\\n\",\n    \"0\\n\",\n    \"1\\n\"\n  ]\n}",
  "difficulty": "interview",
  "url": "https://codeforces.com/problemset/problem/1313/E",
  "starter_code": ""
}