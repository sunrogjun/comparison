{
  "task_id": "APPS/295",
  "problem_id": 295,
  "prompt": "You are given a positive integer $n$.\n\nFind a sequence of fractions $\\frac{a_i}{b_i}$, $i = 1 \\ldots k$ (where $a_i$ and $b_i$ are positive integers) for some $k$ such that:\n\n$$ \\begin{cases} \\text{$b_i$ divides $n$, $1 < b_i < n$ for $i = 1 \\ldots k$} \\\\ \\text{$1 \\le a_i < b_i$ for $i = 1 \\ldots k$} \\\\ \\text{$\\sum\\limits_{i=1}^k \\frac{a_i}{b_i} = 1 - \\frac{1}{n}$} \\end{cases} $$\n\n\n-----Input-----\n\nThe input consists of a single integer $n$ ($2 \\le n \\le 10^9$).\n\n\n-----Output-----\n\nIn the first line print \"YES\" if there exists such a sequence of fractions or \"NO\" otherwise.\n\nIf there exists such a sequence, next lines should contain a description of the sequence in the following format.\n\nThe second line should contain integer $k$ ($1 \\le k \\le 100\\,000$)\u00a0\u2014 the number of elements in the sequence. It is guaranteed that if such a sequence exists, then there exists a sequence of length at most $100\\,000$.\n\nNext $k$ lines should contain fractions of the sequence with two integers $a_i$ and $b_i$ on each line.\n\n\n-----Examples-----\nInput\n2\n\nOutput\nNO\n\nInput\n6\n\nOutput\nYES\n2\n1 2\n1 3\n\n\n\n-----Note-----\n\nIn the second example there is a sequence $\\frac{1}{2}, \\frac{1}{3}$ such that $\\frac{1}{2} + \\frac{1}{3} = 1 - \\frac{1}{6}$.",
  "solutions": "[\"from math import sqrt\\n\\ndef phi(u):\\n\\tans = u\\n\\tfor i in range(2, int(sqrt(n)) + 1):\\n\\t\\tif u % i == 0:\\n\\t\\t\\twhile u % i == 0:\\n\\t\\t\\t\\tu = u / i\\n\\t\\t\\tans = ans - int(ans / i)\\n\\tif n > 1:\\n\\t\\tans = ans - int(ans / n)\\n\\treturn ans\\n\\ndef binpow(u, a, mod):\\n\\tans = 1\\n\\tif a == 0:\\n\\t\\treturn 1;\\n\\twhile a > 0:\\n\\t\\tif a % 2 == 0:\\n\\t\\t\\tu = (u ** 2) % mod\\n\\t\\t\\ta = int(a / 2)\\n\\t\\telse :\\n\\t\\t\\tans = (ans * u) % mod\\n\\t\\t\\ta = a - 1\\n\\treturn int(ans)\\n\\nn = int(input())\\n\\nb1 = 1\\nb2 = 0\\nnn = n\\nfor i in range(2, int(sqrt(n)) + 1):\\n\\tif n%i == 0 :\\n\\t\\twhile nn % i == 0:\\n\\t\\t\\tb1 = b1 * i\\n\\t\\t\\tnn = nn / i\\n\\t\\tb2 = int(n / b1)\\n\\t\\tbreak\\n\\nif b2 < 2:\\n\\tprint(\\\"NO\\\")\\n\\treturn\\na1 = b1 - binpow(b2, phi(b1) - 1, b1)\\na2 = b2 - int((a1*b2+1)/b1)\\nprint(\\\"YES\\\")\\nprint(2)\\nprint(a1, b1)\\nprint(a2, b2)\\n\", \"#   ==========     //\\\\\\\\       //||     ||====//||\\n#       ||        //  \\\\\\\\        ||     ||   // ||\\n#       ||       //====\\\\\\\\       ||     ||  //  ||\\n#       ||      //      \\\\\\\\      ||     || //   ||\\n#   ========== //        \\\\\\\\  ========  ||//====|| \\n#  code\\n\\ndef egcd(a, b):\\n    if a == 0 :   \\n        return b, 0, 1\\n             \\n    gcd, x1, y1 = egcd(b % a, a)  \\n\\n    x = y1 - (b//a) * x1  \\n    y = x1  \\n     \\n    return gcd, x, y\\n\\ndef main():\\n    n = int(input())\\n    div = []\\n    d = set()\\n\\n    m = n\\n\\n    i = 2\\n    while i * i <= n:\\n        cnt = 0\\n        while n % i == 0:\\n            cnt += 1\\n            n //= i\\n            d.add(i)\\n        if cnt > 0:\\n            div.append((cnt, i))\\n        i += 1\\n    \\n    if n > 1:\\n        div.append((1, n))\\n        d.add(n)\\n\\n    for i in d:\\n        if i == m:\\n            d.remove(i)\\n            break\\n    \\n    if len(d) < 2:\\n        print('NO')\\n        return\\n    \\n    ans1 = 1\\n    for i in range(div[0][0]):\\n        ans1 *= div[0][1]\\n    \\n    ans2 = 1\\n    for i in div[1:]:\\n        for j in range(i[0]):\\n            ans2 *= i[1]\\n    \\n    gcd, x, y = egcd(ans2, -ans1)\\n    if x < 0 or y < 0:\\n        gcd, x, y = egcd(ans1, -ans2)\\n        x,y = y,x\\n    \\n    print('YES')\\n    print(2)\\n\\n    if ans2 * x + ans1 * y == m - 1:\\n        print(x, ans1)\\n        print(y, ans2)\\n    elif ans2 * (ans1 - x) + ans1 * y == m - 1:\\n        print(ans1 - x, ans1)\\n        print(y, ans2)\\n    elif ans2 * x + ans1 * (ans2 - y) == m - 1:\\n        print(x, ans1)\\n        print(ans2 - y, ans2)\\n    else:\\n        print(ans1 - x, ans1)\\n        print(ans2 - y, ans2)\\n\\n    return\\n\\ndef __starting_point():\\n    main()\\n__starting_point()\"]",
  "input_output": "{\n  \"inputs\": [\n    \"2\\n\",\n    \"6\\n\",\n    \"3\\n\",\n    \"4\\n\",\n    \"5\\n\",\n    \"7\\n\",\n    \"10895\\n\",\n    \"16968\\n\",\n    \"18438\\n\",\n    \"9589\\n\",\n    \"16705\\n\",\n    \"2789\\n\",\n    \"15821\\n\",\n    \"96120064\\n\",\n    \"49438110\\n\",\n    \"32954134\\n\",\n    \"71851857\\n\",\n    \"6094109\\n\",\n    \"77044770\\n\",\n    \"58644781\\n\",\n    \"792852058\\n\",\n    \"208253300\\n\",\n    \"584467493\\n\",\n    \"967671675\\n\",\n    \"381468071\\n\",\n    \"539044761\\n\",\n    \"672783194\\n\",\n    \"1000000000\\n\",\n    \"640603919\\n\",\n    \"353407931\\n\",\n    \"517920199\\n\",\n    \"262759087\\n\",\n    \"860452507\\n\",\n    \"685518877\\n\",\n    \"846706411\\n\",\n    \"536870912\\n\",\n    \"387420489\\n\",\n    \"244140625\\n\",\n    \"282475249\\n\",\n    \"418195493\\n\",\n    \"214358881\\n\",\n    \"20151121\\n\",\n    \"887503681\\n\",\n    \"62742241\\n\",\n    \"25411681\\n\",\n    \"295943209\\n\",\n    \"208466113\\n\",\n    \"103756027\\n\",\n    \"424759273\\n\",\n    \"294390793\\n\",\n    \"146521747\\n\",\n    \"303427699\\n\",\n    \"706815862\\n\",\n    \"788277261\\n\",\n    \"525518174\\n\",\n    \"294053760\\n\",\n    \"367567200\\n\",\n    \"551350800\\n\",\n    \"698377680\\n\",\n    \"735134400\\n\",\n    \"321197185\\n\",\n    \"321197186\\n\"\n  ],\n  \"outputs\": [\n    \"NO\\n\",\n    \"YES\\n2\\n1 2\\n1 3\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"YES\\n2\\n1 5\\n1743 2179\\n\",\n    \"YES\\n2\\n7 8\\n265 2121\\n\",\n    \"YES\\n2\\n1 2\\n4609 9219\\n\",\n    \"YES\\n2\\n16 43\\n140 223\\n\",\n    \"YES\\n2\\n4 5\\n668 3341\\n\",\n    \"NO\\n\",\n    \"YES\\n2\\n8 13\\n468 1217\\n\",\n    \"YES\\n2\\n219 256\\n54267 375469\\n\",\n    \"YES\\n2\\n1 2\\n12359527 24719055\\n\",\n    \"YES\\n2\\n1 2\\n8238533 16477067\\n\",\n    \"YES\\n2\\n1 3\\n15967079 23950619\\n\",\n    \"YES\\n2\\n5 7\\n248739 870587\\n\",\n    \"YES\\n2\\n1 2\\n19261192 38522385\\n\",\n    \"YES\\n2\\n11 13\\n694021 4511137\\n\",\n    \"YES\\n2\\n1 2\\n198213014 396426029\\n\",\n    \"YES\\n2\\n3 4\\n13015831 52063325\\n\",\n    \"YES\\n2\\n17 19\\n3238047 30761447\\n\",\n    \"YES\\n2\\n1 9\\n95572511 107519075\\n\",\n    \"NO\\n\",\n    \"YES\\n2\\n2 3\\n59893862 179681587\\n\",\n    \"YES\\n2\\n1 2\\n168195798 336391597\\n\",\n    \"YES\\n2\\n403 512\\n415802 1953125\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"NO\\n\",\n    \"YES\\n2\\n6233 8443\\n6463 24691\\n\",\n    \"YES\\n2\\n371 8443\\n11749 12289\\n\",\n    \"YES\\n2\\n14986 17203\\n3182 24691\\n\",\n    \"YES\\n2\\n7436 11923\\n9292 24691\\n\",\n    \"YES\\n2\\n2769 11923\\n9435 12289\\n\",\n    \"YES\\n2\\n435 12289\\n23817 24691\\n\",\n    \"YES\\n2\\n1 2\\n176703965 353407931\\n\",\n    \"YES\\n2\\n2 3\\n87586362 262759087\\n\",\n    \"YES\\n2\\n1 2\\n131379543 262759087\\n\",\n    \"YES\\n2\\n81 128\\n843538 2297295\\n\",\n    \"YES\\n2\\n29 32\\n1076857 11486475\\n\",\n    \"YES\\n2\\n15 16\\n2153714 34459425\\n\",\n    \"YES\\n2\\n11 16\\n13640189 43648605\\n\",\n    \"YES\\n2\\n29 64\\n6281666 11486475\\n\",\n    \"YES\\n2\\n2 5\\n38543662 64239437\\n\",\n    \"YES\\n2\\n1 2\\n80299296 160598593\\n\"\n  ]\n}",
  "difficulty": "interview",
  "url": "https://codeforces.com/problemset/problem/1089/F",
  "starter_code": ""
}